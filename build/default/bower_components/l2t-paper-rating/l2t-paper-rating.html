<html><head><link rel="import" href="../polymer/polymer-element.html"><link rel="import" href="../paper-icon-button/paper-icon-button.html"><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="import" href="../iron-icons/iron-icons.html"></head><body><dom-module id="l2t-paper-rating"><template><style>:host{display:inline-block;--paper-icon-button-ink-color:var(--rating-ink-color, --primary-text-color);}:host([hidden]){display:none;}:host([readonly]):focus,
      :host([readonly]) .stars:focus{outline:0;}.stars{display:inline-flex;position:relative;}.stars:hover .icon-container:not([disabled]),
      .stars .icon-container.active,
      .stars .icon-container:not([disabled]):hover,
      .stars .icon-container:not([disabled]):focus{opacity:1;}.stars .icon-container{color:var(--rating-icon-color, --primary-text-color);opacity:var(--rating-unselected-opacity, .4);width:calc(var(--rating-icon-size,28px) + var(--rating-icon-padding,2px)*2);height:calc(var(--rating-icon-size,28px) + var(--rating-icon-padding,2px)*2);padding:var(--rating-icon-padding,2px);will-change:transform;transition:transform .2s cubic-bezier(.51, .92, .24, 1);}.stars .icon-container:not([disabled]):hover{transform:scale(1.2);}.stars .icon-container[disabled]{cursor:default;}.stars .icon-container:not([disabled]):hover~.icon-container{opacity:var(--rating-unselected-opacity, 0.4);}.stars .stars_half__container{position:absolute;display:inline-flex;left:0;}.stars .stars_half__container .stars_half__spacer{width:calc(var(--rating-icon-size,28px) + var(--rating-icon-padding,2px)*2);height:calc(var(--rating-icon-size,28px) + var(--rating-icon-padding,2px)*2);pointer-events:none;}.stars .stars_half__container .stars_half{width:calc((var(--rating-icon-size,28px) + var(--rating-icon-padding,2px)*2)/2);height:calc(var(--rating-icon-size,28px) + var(--rating-icon-padding,2px)*2);overflow:hidden;pointer-events:none;}.stars .stars_half iron-icon{color:var(--rating-icon-color, --primary-text-color);opacity:1;width:var(--rating-icon-size,28px);height:var(--rating-icon-size,28px);padding:var(--rating-icon-padding,2px);}</style><div class="stars" id="stars"><template is="dom-repeat" items="[[_convertArray(total)]]"><paper-icon-button icon="[[icon]]" on-tap="_tapHandler" disabled$="[[readonly]]" class$="[[_compareVals(rating,item)]]" value$="[[item]]"></paper-icon-button></template><template is="dom-if" if="[[readonly]]"><div class="stars_half__container"><template is="dom-repeat" items="[[_convertArray(rating)]]"><div class="stars_half__spacer"></div></template><div class="stars_half" hidden$="[[_isInt(rating)]]"><iron-icon icon="[[icon]]"></iron-icon></div></div></template></div></template><script>class L2tPaperRating extends Polymer.mixinBehaviors([Polymer.IronA11yKeysBehavior],Polymer.Element){static get is(){return"l2t-paper-rating"}static get properties(){return{keyEventTarget:{type:Object,value:document},icon:{type:String,value:"star"},rating:{type:Number,value:0,reflectToAttribute:!0,notify:!0,observer:"_ratingChanged"},readonly:{type:Boolean,value:!1},total:{type:Number,value:5,reflectToAttribute:!0,observer:"_setAriaAttr"}}}get keyBindings(){return{left:"_ratingDecrease",down:"_ratingDecrease",right:"_ratingIncrease",up:"_ratingIncrease",pageup:"_ratingMax",pagedown:"_ratingMin"}}_compareVals(r,i){if(this.readonly&&!this._isInt(this.rating)){if(Math.ceil(r)>i){return"active icon-container"}else{return"icon-container"}}else{if(r>=i){return"active icon-container"}else{return"icon-container"}}}_convertArray(n){let array=[];for(let i=0;i<Math.floor(n);i++){array.push(i+1)}return array}_elementInactive(){return this!==document.activeElement}_isInt(n){return n%1?!1:!0}_ratingChanged(){this._setAriaAttr();if(1<=this.rating&&this.rating<=this.total)return;this.rating=this.rating>=this.total?this.total:1>=this.rating?1:this.rating}_ratingDecrease(){if(this.readonly||this._elementInactive())return;this.rating--;this._setFocus()}_ratingIncrease(){if(this.readonly||this._elementInactive())return;this.rating++;this._setFocus()}_ratingMax(){if(this.readonly||this._elementInactive())return;this.rating=this.total;this._setFocus()}_ratingMin(){if(this.readonly||this._elementInactive())return;this.rating=1;this._setFocus()}_tapHandler(e){if(this.readonly)return;if(!e.path){this.rating=e.currentTarget.getAttribute("value")}else{this.rating=e.path.find(function(e){if(e.classList){return e.classList.contains("icon-container")}else{return!1}}).getAttribute("value")}}_setAriaAttr(){this.setAttribute("aria-valuemax",this.total);this.setAttribute("aria-valuenow",this.rating)}_setFocus(){let allStars=this.$.stars.querySelectorAll("paper-icon-button");for(let star of allStars){if(star.focused)this.focus()}}ready(){super.ready();this._ensureAttribute("role","slider");this._ensureAttribute("tabindex",0);this._ensureAttribute("aria-valuemin",1);this._ensureAttribute("aria-valuemax",this.total);this._ensureAttribute("aria-valuenow",this.rating);this._setAriaAttr()}}window.customElements.define(L2tPaperRating.is,L2tPaperRating);</script></dom-module></body></html>